// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String   @id @default(uuid())
  email         String   @unique
  password      String
  
  fullName      String?
  role          String   @default("PLAYER") 
  
  // Cricketer Details
  age           Int?
  playerRole    String?
  battingStyle  String?
  bowlingStyle  String?

  // Stats
  matches       Int      @default(0)
  runs          Int      @default(0)
  wickets       Int      @default(0)
  
  teamId        String?
  team          Team?    @relation(fields: [teamId], references: [id])
  createdAt     DateTime @default(now())
}

model Team {
  id           String   @id @default(uuid())
  name         String
  purseBalance Float    @default(50000000)
  logoUrl      String?
  accessCode   String   @unique
  themeColor   String?  @default("#E62E2E")

  auctionId    String?
  auction      Auction? @relation(fields: [auctionId], references: [id])
  owner        User[]
  players      Player[]
}

model Auction {
  id              String   @id @default(uuid())
  name            String
  logoUrl         String?
  budget          Float
  status          String   @default("PENDING")
  passcode        String
  theme           String?
  ground          String?
  bidIncrement    String?  @default("Dynamic")
  eventDate       DateTime?
  fluxData        String?  @default("{}") 

  // Live Auction State
  activePlayerId  String?
  currentBid      Float    @default(0)
  currentBidderId String?

  teams           Team[]
  players         Player[]
  createdAt       DateTime @default(now())
}

model Player {
  id            String   @id @default(uuid())
  name          String
  category      String
  basePrice     Float
  soldPrice     Float?
  isSold        Boolean  @default(false)
  order         Int      @default(0) 

  teamId        String?
  team          Team?    @relation(fields: [teamId], references: [id])
  auctionId     String?
  auction       Auction? @relation(fields: [auctionId], references: [id])
}